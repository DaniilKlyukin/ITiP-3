<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:FractalGUI.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="FractalGUI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="Фрактал Ньютона"
        Width="800" Height="800">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <DockPanel Margin="10">
        <!-- Панель управления сверху -->
        <Border DockPanel.Dock="Top"
                Background="#f0f0f0"
                CornerRadius="5"
                Margin="0,0,0,10"
                Padding="10">
            <StackPanel>
                <TextBlock Text="Параметры фрактала" 
                           FontSize="16" 
                           FontWeight="Bold"
                           Margin="0,0,0,10"/>
                
                <Grid ColumnDefinitions="150,*" 
                      RowDefinitions="Auto,Auto,Auto,Auto"
                      RowSpacing="8">
                    
                    <!-- Лимит итераций -->
                    <TextBlock Text="Лимит итераций:" 
                               Grid.Row="0" Grid.Column="0"
                               VerticalAlignment="Center"/>
                    <StackPanel Grid.Row="0" Grid.Column="1" 
                                Orientation="Horizontal">
                        <Slider Minimum="10" Maximum="500" 
                                Value="{Binding IterationsLimit}"
                                Width="150"/>
                        <TextBox Text="{Binding IterationsLimit}" 
                                 Width="50"
                                 Margin="10,0,0,0"/>
                    </StackPanel>
                    
                    <!-- Точность -->
                    <TextBlock Text="Точность:" 
                               Grid.Row="1" Grid.Column="0"
                               VerticalAlignment="Center"/>
                    <StackPanel Grid.Row="1" Grid.Column="1" 
                                Orientation="Horizontal">
                        <Slider Minimum="0.000001" Maximum="0.1" 
                                Value="{Binding Tolerance}"
                                Width="150"/>
                        <TextBox Text="{Binding Tolerance}" 
                                 Width="80"
                                 Margin="10,0,0,0"/>
                    </StackPanel>
                    
                    <!-- Разрешение -->
                    <TextBlock Text="Разрешение:" 
                               Grid.Row="2" Grid.Column="0"
                               VerticalAlignment="Center"/>
                    <StackPanel Grid.Row="2" Grid.Column="1" 
                                Orientation="Horizontal">
                        <Slider Minimum="100" Maximum="1600" 
                                Value="{Binding Resolution}"
                                Width="150"/>
                        <TextBox Text="{Binding Resolution}" 
                                 Width="50"
                                 Margin="10,0,0,0"/>
                    </StackPanel>
                    
                    <!-- Кнопка расчета -->
                    <Button Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                            Content="Построить фрактал"
                            Command="{Binding CalculateCommand}"
                            HorizontalAlignment="Center"
                            Padding="20,8"
                            FontSize="14"
                            IsEnabled="{Binding !IsCalculating}"/>
                </Grid>
            </StackPanel>
        </Border>
        
        <!-- Статус бар -->
        <Border DockPanel.Dock="Bottom"
                Background="#e0e0e0"
                Padding="8"
                Margin="0,10,0,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Статус: " FontWeight="Bold"/>
                <TextBlock Text="{Binding Status}" Margin="5,0,0,0"/>
                
                <!-- Индикатор загрузки -->
                <Border IsVisible="{Binding IsCalculating}"
                        Margin="20,0,0,0">
                    <StackPanel Orientation="Horizontal">
                        <ProgressBar IsIndeterminate="True" 
                                     Width="100"
                                     Height="8"
                                     VerticalAlignment="Center"/>
                        <TextBlock Text=" Расчет..." 
                                   Margin="10,0,0,0"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>
        
        <!-- Область изображения -->
        <Border BorderBrush="Gray"
                BorderThickness="1"
                Background="White"
                CornerRadius="3">
            <Grid>
                <!-- Изображение фрактала -->
                <Image Source="{Binding FractalImage}"
                       Stretch="Uniform"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                </Image>
                
                <!-- Подсказка при отсутствии изображения -->
                <Border IsVisible="{Binding FractalImage, Converter={x:Static ObjectConverters.IsNull}}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="#80FFFFFF"
                        Padding="20"
                        CornerRadius="10">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="👆" 
                                   FontSize="40"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Нажмите 'Построить фрактал'" 
                                   FontSize="16"
                                   Margin="0,10,0,0"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="для начала визуализации" 
                                   FontSize="12"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </DockPanel>
</Window>